# Super_Resolution


## Description

This is a project of image super resolution.

## Requirements

In this project, Image restoration toolbox on github was used. Please refer to [cszn/KAIR](https://github.com/cszn/KAIR) for installation.

To install other requirements:

```setup
pip install -r requirements.txt
```
## Dataset Preparation
#### Prepare annotations
+ Use ```data_process/prepare_custom_datasets.py``` to resize and generate training and testing pairs.
+ In this assignment, high resolution images are resized to 96x96, low resolution images are resized to 32x32.
+ In this assignment, SwinIR structure provided in [cszn/KAIR](https://github.com/cszn/KAIR) is used. The training settings needs to be configured in ```train_swinir_sr_classical.json```.

#### Project structure
```
KAIR
└─── datasets
│    │
│    └─── train
│    │    │  hr_96 (high resolution images folder)
│    │    |  lr_96 (high resolution images folder)
│    │
│    └─── options
│         └─── swinir
│             | train_swinir_sr_classical.json 
│             |  ...
│
└─── result
└─── main_test_swinir.py
└─── ...
```


## Training

To train the model used in this project, run this command:

```train
cd KAIR
python main_train_psnr.py --opt options/swinir/train_swinir_sr_classical.json
```

## Test

To test the trained model, run:

```test
python3.6 main_test_swinir.py --task  classical_sr  --scale 3 --model_path ${model_path} --folder_lq ${test_images_path} --folder_gt datasets/testing_lr_fake_gt/ --training_patch_size 48
```
+ The original testing code on only support upscale factor is 4 when there is no ground truth during testing (the upscale factor of this project is 3)
+ The result images were generated by putting a fake ground truth folder, which is by resizing original testing images using upscale factor 3. 

## Trained Models

The trained model can be downloaded here:

https://drive.google.com/drive/folders/1ZHgGTmVowVyZCTPjIAQE-qTjD3XSRVhk?usp=sharing

## Results

The model achieves the following performance on :


| Model name  | PNSR    |     |
| ----------- | ------- | --- |
| Faster-rcnn | 27.2941 |     |
